package cn.hackcoder;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.Set;
import java.util.Stack;

/**
 * 1249. Minimum Remove to Make Valid Parentheses
 */
public class MinimumRemoveToMakeValidParentheses {
	public String minRemoveToMakeValid(String s) {
		Set<Integer> removeChars = new HashSet<>();
		Stack<Integer> stack = new Stack<>();
		for (int i = 0; i < s.length(); i++) {
			if (s.charAt(i) == '(') {
				stack.push(i);
			} else if (s.charAt(i) == ')') {
				if (!stack.isEmpty()) stack.pop();
				else {
					removeChars.add(i);
				}
			}
		}

		removeChars.addAll(new ArrayList<>(stack));
		StringBuilder sb = new StringBuilder();
		for (int i = 0; i < s.length(); i++) {
			if (!removeChars.contains(i)) sb.append(s.charAt(i));
		}
		return sb.toString();
	}

	public static void main(String[] args) {
		System.out.println(new MinimumRemoveToMakeValidParentheses().minRemoveToMakeValid("lee(t(c)o)de)"));
		System.out.println(new MinimumRemoveToMakeValidParentheses().minRemoveToMakeValid("))(("));
		System.out.println(new MinimumRemoveToMakeValidParentheses().minRemoveToMakeValid("(a(b(c)d)"));
		System.out.println(new MinimumRemoveToMakeValidParentheses().minRemoveToMakeValid("())()((("));
		long startTime = System.currentTimeMillis();
		System.out.println(new MinimumRemoveToMakeValidParentheses().minRemoveToMakeValid("()o())()(p()()((())(()((())()()(())p))((()((()n))()(((((())g(()((()a)(v)(((((()((x)(())()))()y())())z)()((())))((()(()(()((()d(()(()((()(ec()(((()k(v()))()(x))(())((()())(((z()))n)()()((())())()()())(ai)())())()k)()))e)))()))i()(()(((p((()()()(()))b()))e()()())(y))))()()(()))))))()))((l()m))))(i()()))())))()i))())()))))))()oh)(())((()()(()()(((i((()(((((())((((()))()()))h)b)))))v()(())(k)))(()(j)r((()))u)u((pl))(t()(((()((()s)p(())))))())())(y((((b((()(q())h(f()((o()(()()((()((o()(()())((())q))))x)()())))(((((v)(((((()(((())()(()))))p(()(i)(()))((((nh()))()()((()))j)(()(()((()))c(l(()()((((()((a))m(()())))(((i)((u)(())))))(()()(()(((()((()()))z))()))()()((q)((()hh((()))()c()dw(()(()t(()d()()(i()))((()))))((()))())f()))()())()a((())((i)((z(())()(((())(()(()((()j))(()(()())f()o()((())(())()(())eq((()))()v))g)()n())(((((()()(((()())))(()(u(()()())())))()((())()(((wu))()()(())(rc)())((())()))(a)()d)(()()((f))))()(g()))(())))(((g(jo))()(((l)((((((())()))((((()((()())((())(()g)((((())(h)()))()()))xk()(()f(((((()()((()))()()(()()rpt)))(()))()))z)(((e)))v))(u)(()(b)()()(()(()()(())(v()()(()(((((((())))()))))((()()((()))()z((u(()((o((()(())()())r((())()(a)()()w())(((()))))((d((w(()(j))(())()(((()((n)()(()))))p)))(())m(((u()i))))(()()))(((()())())())()())()((q))))(((o)(u)c)())))o())())(((())q))(()((i)((n()(()))(((()))kqs))c)))(d))())))))()())fy(()f()()w))))))))()))(((()))(((s((()))))(((vz)())b))))()(s()n(())u))(((())(())))s()(()(((()((())))(()(())))(((())((()))())()q)((()))())(()()o))(()()(()))(())((c))(((())e)()()(((((m)()()z(())(c(j()(()((()((d))(()((v((())q()))()())(x((((kf((()l))))))()))))()(mm)(rfb)()(((()(()()((q(((ya)p()e))()))()g((()k))()())()))((((())))))(()()())((((())(()n))zm()(j(j(v(j((f)())(()))()x(((()(())()((()()e()(())()))(())()((())yp)(()(((()))()(s)(z(())(((((()dt))((()()())()()())))(ff())())(((()()(()))))())(o)h)()))())p(()c)())((r)m)a)(()()))(d)((()i)(())())(())))()(ss(s(())))s()(a))))((c())(())()r(()b)((((((((((())n()))(())))))()(()))))((()f)(of)(((u)()(()(((b((()l))())((()())()()()()))o)()()(((()()))()b)((()((())c()))((()(())(()j(((((((())((()(((()())()))))((((()h(()(r))))))((r))((()p())))()))()ifb((((i)))())()))v(x())((j((y)()(((d))))l)((()(()))))))m))))()g)()n()()n))((())))(w()s(()c()()()())(s)v)r)e)((l()()p))(t))j))()(v)()))(()e(ua(()()())()((o)(n)()()((()r)(((((()()i(())(kp)((()((())()((f()((((()(()((((m)()()(())v))()))()()()((((()i()())(())(())((((r(((t)m()((((l(()(()())((())))))))())(()))))(b(())(g()))(())))(r(()((((((()()()e)(()(())(r(()l)()(()()(()z))))))(()()q((g))()(((ue)((()))(((((fq()((()(()()(i)))o)(())))())))())(())())())))())((()()(((()()))(())()((((((((()(((()))((h()()))())))m()()()())f(()))(t))(xhm(()))))dg()c)))kj))))())((i)())p()))er))())(st(()))()i(())(())(())))((()(((((g()(((()()()n))(f)()((()(())m))))((h)))()((())))())(()((()(()()())(((())()(((((()())k(()))((())(())u))())((((()))))()))()p))())))()h))())(h((()(()((()))()(())(()(((i(vd((((((()(()h()(()))f)()()q)(((h(((((())()(()()(((()(i)((((()()c))((nz()()k()((()))())c)))))())()((()))())(()))f(((()(d()))()))b()())((((z))())()))()b(p((()((()sj()()))x))()()u)(()(()(a))(((x(i(((((((()()()()(a((r)((((((p(((h)e()(((x)e()))())()(g()(())())(()()()(o(()(())))))(())(qe))()z))()((((()(((((()(g))()()c(()()))a(((((i)))h())c(((())())((()(v)(((())))())()((())(())((()((((()))))))))))))())))))((v()())(()(((c)()())h))))())p((())))((a((()()()()i)(()())((r)))()i)y()))((()()))((())i()()n()()(())l)()))()(z()(()(()((((((kd(()()g()))()i))(()()(((()(())(()(()z(())(((()))()(((()(()(())(q()())())(()()())()()()())()())))()j)()(((()()(())(()y((())((v)((((())())(((h))()(())())n()))(())u)))(()(n()e)))()a)))((()))()i()((k((d(())()(()))f)()(b))z(nb)j))(r))(()(((((((()(d(()())()x()()))))n()())()p())(g)((((((f(((()(()())((()()))))(cp(y((((()))h(())(())(()(((jn(()(o())()l()()(u(())((()()()f()((())(())())c)()))(((()))())()(()()()(e))))))f))))))))())()(()(()(((())()(p())(n)))()))())((((())()((((())())))(()()())(((())(()))(f())c)((i)))((g)(qe))))))))))))))()()h)((())))))())()()w()s(()()(()(()()(((()()((()))((j)))(()(((y)p)))))()))ji(()(a()())()))()))o)()(k))(()((()l)))(()))(())((()()ag((a(((h(())()u)()((()()()u(()i()()()((r()kl)(()((())))))(((()))(((()()(()((()((())a())()(((())()()z(s))h((())))(()(((o))(()((())u((()))fz)(())))))()((())()(()(((p(()())(((e()hw)()()()((()()))()e(())z()((((()())((()(((((v)ga((()(((()((((((())))()()()i)()())))(((())))))))(())()((i)s))())))))(()))())))h)(()))s(w))(((()())()()g()e)))()()((mn(()()(())()))(())(f()y)v))()(())))((()((()((()()((()()q))))()(((()())s())(s))()))))))()))()))()))()))()))()c(eb)i)(()f((())()()(x))))))cd()()(w)()(()))()()(((()(x))())(()ok)(()t((()r))(((g)()(()()()((yt))))((()())))())())))(())(((()((()y()()))d()())((()((((()(())d(())))(t)()(ja))(((()(())r()()))(((h)(()))(t)(())(()))()((l)()(())())((())(())))(k(((()((()()z()v)()g())))()(()()))))a(()((()i((()(()())(((()))))q((v())))v)())())(k)))())())())((z)(()((k)(()))()()))())))(((m((())(()())(((z))())((o(())())u)(((()c()()((())())()())(())u)))((b(((z)()(((d(go(m()))((((((l))y(()())((()))())(u)(((()(()()()(((()((b))(g(((()(()(()((()u(()()((s))))u()))()((((())))))()((()((()l()w))g()((s))(())))())())())()(((w)(()(((()))(()()(((r)((((())((((()(((()(((()()(y))())((p()((())()))(w)()()t)(()))(()()))()()())))))())(()()x))((i(()l()))i()(a(()((o()()(()xn)(()()()(p(e)(((())(()))(((c)))())((a)((()(d)())(()()()(x((())())())()())(()()))())))(()()(o))q))))))))()y())))z))))))z()((((q((t)(()(()(lh()(()))y)())())s)(()()c(a)z()((())(()()))(())(())e))(()()))qx())((())z))(()()(h()))f)n)(())((rf))()))))())m(e())()(()))()()))))))))))(g((()(()))(()())jd(((())d(((b()))()(()v())())))))))((())))o))(()((((x((()()())(()))())())((((((()()m)(())))))(())())pn))()(((())))())(())(())()(((()(o))((())y()(((()z((()(()()()))()(((()))())())()(()))))()())()(((()))r)((s(h(()())))())(()m)()))())())((())d)()))(())()e((()))r())()))())()(()()(()i)()))((c))(((hp()(((()()))())(())(()())()())((()))()f)()(j)())d()z))a()))(())()f(((()((()c)(())))))((m(()()))()))))(())((((()))(())()(())((()(()b())(r(((((x)))(())))((h)y(())s))()(h)(())(()q(()))((()((()()q)(((u)())i()(())))()(())()((j))((f)z())(r()(())((((((j()(((((m)(((n()()))())()i()()t)()(((()(((g)))(()((e())y))s)(()(((())hu()(())()(((())(()r()())())))(()))n())())(((n(()()(()(((()))()))(()(((()())i)a)(((()))(())))((()(())))(((()(((g())(()())()))))))())))e)()()h())())())()))b(((o)(())(i)))()(((((((())()(()))()))()))()))()(kt()((())))(()))())((())(()(g()))((e(()))(())())))))))()()()((a(((((()))))((((())(((())))))l)))(yk((()(()((((()))()((d(()c(())())))()))(()())()()())((()((((()(((()(()(())u)(()((()))())((((()()j)()()kt(((()))))())((((h))(())()())o())(((((((u())i()()))((())(d())()(((())()))))))()(((((())()))))(ed(((()()))())((()()()(())()lu))q((n)))a)))(((()(()))((()j(((()k()()v)(((g(())t(((((((q)k))v())))t()q)()))((r(())()())())())()(())(m()()((()(((o((ny())))(d(u)(()()(j()((b)())))(m)))))())n()()(((g)i)))(())(o(())i(f()()(()))))k())())))u)((((()((())))())()()))))i))()()))))))w()(()(()((((f((u)))(f))n()()))(((m((()h((g(()o(()(((()))(y)((((())))())))))k)(j()()n)(()))(((g))(())(())(r()())))()()((()))((((()()((()))))()()(())()))r(())))))d))))())((x)))))))e)(((()()t(()))(u()))))(())(()))g((()()))a)()(())v(())(())((()))()))k))))()()(()()(d())(()c)(()()(()(()()()h()(c)g(())()()(s(()))j()(u))(py)(()t)()(()()()())(()h)v))()a)((()()p)(())(((((l)()(()(()((()z()))()e))()()))())()()))(()))((()(()(l(()(()))((((((()))()))))q()((()()((h)((wb))))((((()v)())(())))(b()(ba)(()()(((((((()))())()()()))()(j)))in(p)))v()()e)))))z(())))(()()()(()()()))f))())())))()))()))m)(x(q))w))((()()))()w)(()((()y()((()()())t)))((m)y(()()))())()()())((g((()((v())())))o()()(((()))())()()))((())))())()())()))((()()(())()(d())(())(()o))))())d)(((()()()(((f((()()))p(()((()(t)(()()()(d)d)(s()l()(())()o(())))))))()()())))))))())))(()())((()(gf)((c))())p()(())(()))(()((s())(()(((h))((()()()()()()c)))()))(()(d(()(()))))))())))((h)(()((y)()()()(((c())()((())()(((l))(((o(d(y))uk))e())(()(h())w()())()p(((()))((((()(()))(())(q)((l)))()(()))())))))))()))())))()))))u()()(fs(g)()b())()))(())(k(((jh)(()())())(((((n((((()(((())(((()((()((o))((()()())))((((()))f())())))m)((()(((((()((())l))((c)p))(i)))n())(())v))((()()))((w))))no)i)))((j))(a(())a((u()(()j(())))(())())l)))))()()((j)(b((()())(((((f(((())))(()()g((b(((r))(()()(z(()()h)e))()(((()(((()((((((t)s()(()()(()z)()(()()(((())))))((())()))))()))()))(p)()()(r((((((j)))z())(f()))((()a()(((((o(((((r((())()(()(((())(((((())()(()(((()()(())((()))(g))z)()()))e))))))))())())()))(f(((())))(((())(a())))())a)()()()(x())))())()((q))(()))()()u)))))(j((()(j))()()((()())fur)((f((z))(()()(())(()a))a()()))()))))())()))))())()(vh)(((()()((()(())c)())))((yu()))))y()(()((((()q((())()()()((e))()))()()(i(())()())))(())()(z))))s)())vmce))()n)((()))()x()()((f(())(((()(()(()))))())((()p)))))()(a()()(((h)))()(())()()w(()((p))))())(oc(())))()))(()i))()((((()()((()())()(())(((()))()()))(u))(()()()()))(()))((e)y()())(()()(()s(()()())h))(()d)())(((()(((((s)))()(()((((()gp(((()))x((()r(())((())()())x(())())(((q)m())))))))())((()()(())()())(((t)(((()((((()(()))(()(()())(a))(()brq()))))o()(()p)()(v()b)()()))())((()w((j(()))(g((((((()()x)(())((())())e()((((((s)()))())()(())r)(((((()))())())(())((()((((((c((()(dg)p)()(()(()(()((z()))))))))))(())(((((d)()(()(((k))((()(k)())))())())(()())((y)(((()()((()))))((()y)(())()))())((())t)))))(l(())(((n(()o)))(yj)h(p(())())((())()(n)(())()(()((((()g)(()))l)(()))(())v()(ni)i)()()))()((()()b(((p(((()(((t))z(e()()))c)k(()(a(u))()(())()(r))(u()())()((r()k()()))())()(((()()(()(h((()))(()())()(g))(((()k()f((()())p()()()()d)z))(()())))(())()m()()))()()))(()(((())(()))))()p)(()()b((()((w((j))((())(a)))((b)c))))(((y)))()()))y()(((())))(()))x)))))((()()(((()((()c(())((())b)))()))b))o(()j)))(w())(()(()x)))k)((()()(())((()))((())((((()((())())(())(())m(v(((())())))))kk()(q)(()))((()qg(((((((()))()()()((((p)))())))k()((()((k()(()()()()((((()()(c((((v(())()((())(b()((o)((()))((t()(())(a)))))))(p))(()(())(h(())((((()())(()(()))(()(()(())(((()()(((()()()))b()(())())()(()(((()"));
		System.out.println(System.currentTimeMillis() - startTime);
	}
}
